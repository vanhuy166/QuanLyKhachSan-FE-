<!DOCTYPE html>
<html lang="en">

<head>
    <title>CauGiay Hotel</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700|Work+Sans:300,400,700" rel="stylesheet">
    <link rel="stylesheet" href="./fonts/icomoon/style.css">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/magnific-popup.css">
    <link rel="stylesheet" href="./css/jquery-ui.css">
    <link rel="stylesheet" href="./css/owl.carousel.min.css">
    <link rel="stylesheet" href="./css/owl.theme.default.min.css">
    <link rel="stylesheet" href="./css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="./css/animate.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mediaelement@4.2.7/build/mediaelementplayer.min.css">
    <link rel="stylesheet" href="./fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" href="./css/aos.css">
    <link rel="stylesheet" href="./css/style.css">


    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.css">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.css" type="text/css">

    <style>
        .buttonMap {
            display: inline-block;
            position: relative;
            cursor: pointer;
            width: 18%;
            padding: 8px;
            border-radius: 3px;
            margin: 0 20px 10px 0;
            font-size: 12px;
            text-align: center;
            color: #fff;
            background: #ee8a65;
            font-family: sans-serif;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <div class="site-wrap">
        <!-- Form đổi mật khẩu -->
        <div id="modal" style=" display: none; position: fixed; top: 0;  left: 0;  right: 0;  bottom: 0;  background-color: rgba(0,0,0,0.3);   z-index: 100;">
            <div style="margin: 120px auto;   width: 55%;    height: 65%; border-radius:10px;  background-color: white;">
                <div class="row" style="padding-top:50px;">
                    <div class="col-md-6 mx-auto text-center mb-5 section-heading">
                        <h2>Đổi mật khẩu</h2>
                    </div>
                </div>

                <div style="align-items:center; margin: 0 0 0 50%; transform: translateX(-35%); ">
                    <table style="width:80%; height:250px;">
                        <tr>
                            <th>Email :</th>
                            <td><input style="width: 100%;" type="text" id="txtEmail"></td>
                        </tr>
                        <tr>
                            <th>Mật khẩu mới :</th>
                            <td><input style="width: 100%;" type="password" id="txtNewPass"></td>
                        </tr>
                        <tr>
                            <th>Xác nhận :</th>
                            <td><input style="width: 100%;" type="password" id="txtRe_NewPass"></td>
                        </tr>

                        <tr style="margin-top:12px; text-align: center;">
                            <th>
                                <button style="min-width:70px;" type="button" class="btn btn-outline-danger" onclick="DoiMatKhau();">Đổi</button>
                            </th>
                            <td>
                                <button style="min-width:70px;" type="button" class="btn btn-outline-danger" onclick="hideDoiMK();">Thoát</button>
                            </td>
                        </tr>

                    </table>
                </div>
            </div>
        </div>

        <!-- .site-mobile-menu -->
        <div class="site-mobile-menu">
            <div class="site-mobile-menu-header">
                <div class="site-mobile-menu-close mt-3">
                    <span class="icon-close2 js-menu-toggle"></span>
                </div>
            </div>
            <div class="site-mobile-menu-body"></div>
        </div>

        <!-- menu -->
        <div class="site-navbar-wrap js-site-navbar bg-white">
            <div class="container">
                <div class="site-navbar bg-light">
                    <div class="py-1">
                        <div class="row align-items-center">
                            <div class="col-2">
                                <h2 class="mb-0 site-logo"><a href="./index.html">ROOM Co</a></h2>
                            </div>
                            <div class="col-10">
                                <nav class="site-navigation text-right" role="navigation">
                                    <div class="container">

                                        <div class="d-inline-block d-lg-none  ml-md-0 mr-auto py-3">
                                            <a href="#" class="site-menu-toggle js-menu-toggle"><span class="icon-menu h3"></span></a>
                                        </div>
                                        <ul class="site-menu js-clone-nav d-none d-lg-block">
                                            <li class="active">
                                                <a href="./index.html">Trang chủ</a>
                                            </li>
                                            <li class="has-children">
                                                <a href="./DanhSachPhong.html">Phòng</a>
                                                <ul class="dropdown arrow-top">
                                                    <li><a href="./DanhSachPhong.html">Hiện có</a></li>
                                                    <li><a href="./DanhSachPhong.html">Phòng đơn</a></li>
                                                    <li><a href="./DanhSachPhong.html">Phòng đôi</a></li>
                                                    <li><a href="./DanhSachPhong.html">Phòng gia đình</a></li>


                                                </ul>
                                            </li>
                                            <li><a href="./DichVu.html">Dịch vụ</a></li>
                                            <li><a href="./ThongTin.html">Thông tin</a></li>
                                            <li><a href="./LienHe.html">Liên hệ</a></li>


                                            <li class="has-children">
                                                <img src="./images/person_1.jpg" width="50dp" height="	50dp" alt="" style="border-radius: 100px; ;">
                                                <ul class="dropdown arrow-top">
                                                    <li><a href="#">user</a></li>
                                                    <li><a href="./DanhSachPhongDat.html">Lịch sử </a></li>
                                                    <li><a onclick="showDoiMK();">Đổi mật khẩu</a></li>
                                                    <li><a href="./DangNhap.html">Đăng xuất</a></li>
                                                </ul>
                                            </li>
                                        </ul>

                                    </div>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- slide trang chủ -->
        <div class="slide-one-item home-slider owl-carousel">

            <div class="site-blocks-cover overlay" style="background-image: url(./images/hero_1.jpg);" data-aos="fade" data-stellar-background-ratio="0.5">
                <div class="container">
                    <div class="row align-items-center justify-content-center">
                        <div class="col-md-7 text-center" data-aos="fade">

                            <h1 class="mb-2">Welcome To Suites</h1>
                            <h2 class="caption">Hotel &amp; Resort</h2>
                        </div>
                    </div>
                </div>
            </div>

            <div class="site-blocks-cover overlay" style="background-image: url(./images/hero_2.jpg);" data-aos="fade" data-stellar-background-ratio="0.5">
                <div class="container">
                    <div class="row align-items-center justify-content-center">
                        <div class="col-md-7 text-center" data-aos="fade">
                            <h1 class="mb-2">Unique Experience</h1>
                            <h2 class="caption">Enjoy With Us</h2>
                        </div>
                    </div>
                </div>
            </div>

            <div class="site-blocks-cover overlay" style="background-image: url(./images/hero_3.jpg);" data-aos="fade" data-stellar-background-ratio="0.5">
                <div class="container">
                    <div class="row align-items-center justify-content-center">
                        <div class="col-md-7 text-center" data-aos="fade">
                            <h1 class="mb-2">Relaxing Room</h1>
                            <h2 class="caption">Your Room, Your Stay</h2>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Thông tin -->
        <div class="site-section">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6 mb-5 mb-md-0">

                        <div class="img-border">
                            <a href="https://vimeo.com/28959265" class="popup-vimeo image-play">
                                <span class="icon-wrap">
                    <span class="icon icon-play"></span>
                                </span>
                                <img src="./images/img_2.jpg" alt="" class="img-fluid">
                            </a>
                        </div>

                        <img src="./images/img_1.jpg" alt="Image" class="img-fluid image-absolute">

                    </div>
                    <div class="col-md-5 ml-auto">


                        <div class="section-heading text-left">
                            <h2 class="mb-5">Thông tin</h2>
                        </div>
                        <p class="mb-4">Khách sạn Hoàng Hôn luôn mang vẻ đẹp hiện đại xen lẫn nét cổ kính. Đặt khách sạn sớm nhất để hưởng trọn ưu đãi, hứa hẹn một kì nghỉ với những ...</p>
                        <p><a href="https://vimeo.com/28959265" class="popup-vimeo text-uppercase">Xem Video <span class="icon-arrow-right small"></span></a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Danh sách tính năng -->
        <div class="site-section">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 mx-auto text-center mb-5 section-heading">
                        <h2 class="mb-5">TÍNH NĂNG HIỆN CÓ</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-pool display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Hồ bơi</h2>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-desk display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Gọi thức ăn nhanh</h2>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-exit display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Thoát hiểm an toàn</h2>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-parking display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Bãi đổ xe</h2>
                        </div>
                    </div>

                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-hair-dryer display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Tạo mẫu tóc</h2>
                        </div>
                    </div>

                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-minibar display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Quầy bar</h2>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-drink display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Thức uống</h2>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-4 col-lg-3">
                        <div class="text-center p-4 item">
                            <span class="flaticon-cab display-3 mb-3 d-block text-primary"></span>
                            <h2 class="h5">Thuê ô tô</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- khuyến mãi -->
        <div class="py-5 upcoming-events" style="background-image: url('./images/hero_1.jpg'); background-attachment: fixed;">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h2 class="text-white">Summer Promo 50% Off</h2>
                        <a href="#" class="text-white btn btn-outline-warning rounded-0 text-uppercase">Avail Now</a>
                    </div>
                    <div class="col-md-6">
                        <span class="caption">The Promo will start in</span>
                        <div id="date-countdown"></div>
                    </div>
                </div>

            </div>
        </div>

        <!-- bản đồ -->
        <div class="site-section">
            <div class="container">
                <select id="selLanguages" class="buttonMap" onchange="changeLanguages()">
                    <option value="en">English</option>
                    <option value="vi">Vietnamese</option>
                    <option value="fr">French</option>
                    <option value="ru">Russian</option>
                    <option value="zh-Hant">Chinese</option>
                </select>

                <button class="buttonMap" id="ChiDuong" onclick="ChiDuong();">Chỉ đường</button>
                <button class="buttonMap" id="hotel" onclick="Hotel();">Hotel</button>

                <div id="map" style="width:100%; height:650px;"></div>


            </div>
        </div>

        <!-- phản hồi khách hàng -->
        <div class="site-section block-14 bg-light">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 mx-auto text-center mb-5 section-heading">
                        <h2>Phản hồi khách hàng</h2>
                    </div>
                </div>

                <div class="nonloop-block-14 owl-carousel" id="listPhanHoi">

                </div>
            </div>
        </div>

        <!-- footer -->
        <footer class="site-footer">
            <div class="container">
                <div class="row">
                    <div class="col-md-4">
                        <h3 class="footer-heading mb-4 text-white">About</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Repellat quos rem ullam, placeat amet.</p>
                        <p><a href="#" class="btn btn-primary pill text-white px-4">Read More</a></p>
                    </div>
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-6">
                                <h3 class="footer-heading mb-4 text-white">Quick Menu</h3>
                                <ul class="list-unstyled">
                                    <li><a href="#">About</a></li>
                                    <li><a href="#">Services</a></li>
                                    <li><a href="#">Approach</a></li>
                                    <li><a href="#">Sustainability</a></li>
                                    <li><a href="#">News</a></li>
                                    <li><a href="#">Careers</a></li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h3 class="footer-heading mb-4 text-white">Ministries</h3>
                                <ul class="list-unstyled">
                                    <li><a href="#">Children</a></li>
                                    <li><a href="#">Women</a></li>
                                    <li><a href="#">Bible Study</a></li>
                                    <li><a href="#">Church</a></li>
                                    <li><a href="#">Missionaries</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>


                    <div class="col-md-2">
                        <div class="col-md-12">
                            <h3 class="footer-heading mb-4 text-white">Social Icons</h3>
                        </div>
                        <div class="col-md-12">
                            <p>
                                <a href="#" class="pb-2 pr-2 pl-0"><span class="icon-facebook"></span></a>
                                <a href="#" class="p-2"><span class="icon-twitter"></span></a>
                                <a href="#" class="p-2"><span class="icon-instagram"></span></a>
                                <a href="#" class="p-2"><span class="icon-vimeo"></span></a>

                            </p>
                        </div>
                    </div>
                </div>

            </div>
        </footer>
    </div>

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/jquery-migrate-3.0.1.min.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.stellar.min.js"></script>
    <script src="js/jquery.countdown.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/bootstrap-datepicker.min.js"></script>
    <script src="js/aos.js"></script>
    <script src="js/mediaelement-and-player.min.js"></script>
    <script src="js/main.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var mediaElements = document.querySelectorAll('video, audio'),
                total = mediaElements.length;

            for (var i = 0; i < total; i++) {
                new MediaElementPlayer(mediaElements[i], {
                    pluginPath: 'https://cdn.jsdelivr.net/npm/mediaelement@4.2.7/build/',
                    shimScriptAccess: 'always',
                    success: function() {
                        var target = document.body.querySelectorAll('.player'),
                            targetTotal = target.length;
                        for (var j = 0; j < targetTotal; j++) {
                            target[j].style.visibility = 'visible';
                        }
                    }
                });
            }
        });
    </script>

    <!-- Đổi mật khẩu -->
    <script>
        function showDoiMK() {
            $("#modal").css("display", "block");
        }

        function hideDoiMK() {
            $("#modal").css("display", "none");
            $('#txtEmail').val("");
            $('#txtNewPass').val("");
            $('#txtRe_NewPass').val("");
        }

        function DoiMatKhau() {
            var headers = "Bearer " + localStorage.getItem("token");
            $.ajax({
                url: 'http://localhost:8083/api/v1/users/info',
                headers: {
                    "Authorization": headers
                },
                method: 'GET',
                contentType: 'application/json',
                error: function(err) {
                    console.log(err);
                },
                success: function(data) {
                    if (data.email != $('#txtEmail').val()) {
                        alert("Email không chính xác!");
                        return;
                    }

                    if ($('#txtNewPass').val().trim() == "") {
                        alert("Mật khẩu không được để trống!");
                        return;
                    }

                    if ($('#txtNewPass').val() != $('#txtRe_NewPass').val()) {
                        alert("Mật khẩu không khớp!");
                        return;
                    }

                    var newUser = {
                        "id": data.id,
                        "password": $('#txtNewPass').val()
                    }

                    idUser = data.id;
                    $.ajax({
                        url: 'http://localhost:8083/api/v1/users/update',
                        headers: {
                            "Authorization": headers
                        },
                        method: 'PUT',
                        contentType: 'application/json',
                        dataType: 'json',
                        data: JSON.stringify(newUser),
                        error: function(err) {
                            alert("Đổi mật khẩu không thành công!");
                            console.log(err);
                        },
                        success: function(data) {
                            alert("Đổi mật khẩu thành công! Vui lòng đăng nhập lại!");
                            window.location = "./DangNhap.html";
                        },
                        fail: function(response) {}
                    });

                },
                fail: function(response) {}
            });
        }
    </script>

    <!-- load phản hồi -->
    <script>
        $.ajax({
            url: 'http://localhost:8083/api/v1/reviews',
            method: 'GET',
            contentType: 'application/json',
            error: function(err) {
                console.log(err);
            },
            success: function(data) {
                $("#listPhanHoi").empty();
                const len = data.length;
                let table = '';
                for (var i = 0; i < len; ++i) {
                    table += `
                    <div class="p-4">
                        <div class="d-flex block-testimony">
                            <div class="person mr-3" >
                                <img style=" min-width: 150px;  height: 150px;" src="./images/person_` + Math.floor(Math.random() * 10) + `.jpg" alt="Image" class="img-fluid rounded">
                            </div>
                            <div style="flex:1;">
                                <h2 class="h5">` + data[i].username + `</h2>
                                <h3 class="h6">&#40 ` + convertDateTime(data[i].created_date) + ` &#41</h3>
                                <blockquote>
                                    &ldquo; ` + data[i].content + `&rdquo;
                                </blockquote>
                            </div>
                        </div>
                    </div>
                    `;
                }
                document.getElementById('listPhanHoi').innerHTML = table;
            },
            fail: function(response) {}
        });

        function convertDateTime(timeUTC) {
            var today = new Date(timeUTC);
            var dd = today.getDate();
            var mm = today.getMonth() + 1; //January is 0 so need to add 1 to make it 1!
            var yyyy = today.getFullYear();
            var hours = today.getHours();
            var minutes = today.getMinutes();
            var seconds = today.getSeconds();

            if (dd < 10) {
                dd = '0' + dd;
            }
            if (mm < 10) {
                mm = '0' + mm;
            }
            if (hours < 10) {
                hours = '0' + hours
            }
            if (minutes < 10) {
                minutes = '0' + minutes
            }

            if (seconds < 10) {
                seconds = '0' + seconds
            }

            return yyyy + '-' + mm + '-' + dd + ' ' + hours + ':' + minutes + ':' + seconds;
        }
    </script>


    <!-- mapbox -->
    <script>
        mapboxgl.accessToken = 'pk.eyJ1Ijoibmd1eWVudGh1aHVvbmcxOTg3IiwiYSI6ImNrb2Y4dXNlNTBqcmQzMXRyZXA3Yng2NDUifQ.VXut_atNnNAiiw5pi5PwDg';
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [105.85, 21.0], //Tọa độ lãnh thổ Việt Nam
            zoom: 15
        });

        var coordinates;

        const coordinatesHotel = [105.79927, 21.03248]

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                coordinates = [position.coords.longitude, position.coords.latitude]
            });
        }
        console.log(navigator.geolocation);

        //Thêm Control MapboxDirections vào bản đồ
        var directions = new MapboxDirections({
            accessToken: mapboxgl.accessToken,
            unit: 'metric',
            profile: 'mapbox/driving'
        });
        map.addControl(directions, 'top-left');

        map.on('load', function() {

            map.flyTo({
                center: coordinatesHotel,
                essential: true // this animation is considered essential with respect to prefers-reduced-motion
            });

            //thêm marker vào bản đồ
            var marker = new mapboxgl.Marker({
                    color: "red", //Màu của Marker là đỏ
                    draggable: true,
                    anchor: 'bottom', //Nhãn Hà Nội nằm dưới Marker 
                }).setLngLat(coordinatesHotel) //Thiết lập Marker tại hà Nội
                .addTo(map);

            //thêm popup vào bản đồ
            var popup = new mapboxgl.Popup({
                    closeButton: true,
                    closeOnClick: false,
                    anchor: 'top-right',
                }).setLngLat(coordinatesHotel)
                .setHTML("<h1>Cầu Giấy hotel</h1>")
                .addTo(map);
        });

        //thêm navigationControl chứ các nút thu/phóng  và la bàn vào bản đồ
        map.addControl(new mapboxgl.NavigationControl({
            showCompass: true,
            showZoom: true,

        }));

        //thêm nút xác định vị trí người dùng vào bản đồ
        map.addControl(new mapboxgl.GeolocateControl({
            positionOptions: {
                enableHighAccuracy: true
            },
            trackUserLocation: true
        }));

        //thêm ScaleControl vào bản đồ để hiển thị tỉ lệ khoảng cách trên bản đồ so với khoảng cách tương ứng trên mặt đất
        var scale = new mapboxgl.ScaleControl({
            maxWidth: 80,
            unit: 'imperial'
        });
        map.addControl(scale);
        scale.setUnit('metric');

        //thêm nút FullScreen vào bản đồ
        map.addControl(new mapboxgl.FullscreenControl());

        //thêm Sự kiện khi người dùng Click trên bản đồ sẽ hiện lên một Popup hiển thị kinh độ, vĩ độ tại vị trí Nhấn
        map.on('click', function(e) {
            var popup = new mapboxgl.Popup({
                    closeButton: true,
                    closeOnClick: true,

                }).setLngLat([e.lngLat.lng, e.lngLat.lat])
                .setText("vị trí nhấn là: " + e.lngLat.lng + " , " + e.lngLat.lat)
                .addTo(map);
        });
        // Tạo một marker màu xanh blue tại vị trí nhấn đúp chuột trên bản đồ.
        map.on('dblclick', function(e) {
            new mapboxgl.Marker({
                    color: 'blue',
                    draggable: true,

                }).setLngLat([e.lngLat.lng, e.lngLat.lat])
                .addTo(map);
        });

        function ChiDuong() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    coordinates = [position.coords.longitude, position.coords.latitude]
                });
            }

            directions.setOrigin(coordinates);
            directions.setDestination(coordinatesHotel);

            map.flyTo({
                center: coordinates,
                zoom: 15,
                essential: true // this animation is considered essential with respect to prefers-reduced-motion

            });
        }

        function changeLanguages() {
            var language = document.getElementById("selLanguages").value;
            map.setLayoutProperty('country-label', 'text-field', [
                'get',
                `name_${language}`
            ]);
        }

        function Hotel() {
            map.flyTo({
                center: coordinatesHotel,
                zoom: 15,
                essential: true // this animation is considered essential with respect to prefers-reduced-motion

            });
        }
    </script>

</body>

</html>